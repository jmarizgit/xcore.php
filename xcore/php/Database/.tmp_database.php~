<?php

/*@type: CLASS */
/*@author: JOSE MARIZ MELO */
/*@company: KNOSOFT */
/*@release: 08/25/2008 */
/*@description: 
*
*
*
*/

/*@howtouse: 
*
*
*
*
*/

class Database{
	
	
	
	function connectDB($url, $user, $pass, $database, $sgdb){
	
		//@function_desc: Stabilish connection with database server.

		$db = array("server"=>$url, "user"=>$user, "pass"=>$pass, "database"=>$database, "interface"=>"INTERFACE", "sgdb"=>$sgdb);
		
		switch($db['sgdb']){
			case "mysql":	require("./knolib/php/database/db_mysql.php");
							break;
		}
		
		$connection = db_connect($db);
		return $connection;
	}
	
	
	function freeDB($query){
		
		//@function_desc: Free query used in query.
		
		db_free($query);	
	}

	
	function disconnectDB($connection){

		//@function_desc: Close database connection.
	
		db_disconnect($connection);
	}
	
	
	
	function noInjection($value){
		
		//@function_desc: Replace reserved words in variable value.
		
		$newvalue = preg_replace(sql_regcase("/(from|select|insert|delete|where|drop table|show tables|#|\*|--|\\\\)/"),"",$value);
		$newvalue = trim($value);//limpa espacos vazio
		$newvalue = strip_tags($value);//tira tags html e php
		$newvalue = addslashes($value);//Adiciona barras invertidas a uma string
		return $newvalue;
	}
	
	
	
	function selectQueryDB($connection, $value, $type){
		
		//@function_desc: Execute and return SQL query.
	
		$sql = $value;
		$myquery = db_query($sql, $connection);
		$result = mysql_fetch_array($myquery);
		db_free($myquery);				
		return $result;	
	}
	
	
	
}

?>